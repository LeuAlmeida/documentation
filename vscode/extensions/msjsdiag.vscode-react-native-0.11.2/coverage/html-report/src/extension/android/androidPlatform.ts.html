<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src\extension\android\androidPlatform.ts</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../../../prettify.css" />
    <link rel="stylesheet" href="../../../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../../../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../../../index.html">all files</a> / <a href="index.html">src/extension/android/</a> androidPlatform.ts
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>0/102</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>0/46</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/16</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>0/102</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT license. See LICENSE file in the project root for details.
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>import * as Q from "q";
<span class="cstat-no" title="statement not covered" ></span>import * as semver from "semver";
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>import {GeneralMobilePlatform, MobilePlatformDeps } from "../generalMobilePlatform";
import {IAndroidRunOptions} from "../launchArgs";
<span class="cstat-no" title="statement not covered" ></span>import {AdbHelper, AndroidAPILevel, IDevice} from "./adb";
<span class="cstat-no" title="statement not covered" ></span>import {Package} from "../../common/node/package";
<span class="cstat-no" title="statement not covered" ></span>import {PromiseUtil} from "../../common/node/promise";
<span class="cstat-no" title="statement not covered" ></span>import {PackageNameResolver} from "./packageNameResolver";
<span class="cstat-no" title="statement not covered" ></span>import {OutputVerifier, PatternToFailure} from "../../common/outputVerifier";
<span class="cstat-no" title="statement not covered" ></span>import {TelemetryHelper} from "../../common/telemetryHelper";
<span class="cstat-no" title="statement not covered" ></span>import {CommandExecutor} from "../../common/commandExecutor";
<span class="cstat-no" title="statement not covered" ></span>import {LogCatMonitor} from "./logCatMonitor";
<span class="cstat-no" title="statement not covered" ></span>import {ReactNativeProjectHelper} from "../../common/reactNativeProjectHelper";
<span class="cstat-no" title="statement not covered" ></span>import * as nls from "vscode-nls";
<span class="cstat-no" title="statement not covered" ></span>import { InternalErrorCode } from "../../common/error/internalErrorCode";
<span class="cstat-no" title="statement not covered" ></span>import { ErrorHelper } from "../../common/error/errorHelper";
<span class="cstat-no" title="statement not covered" ></span>import { isNullOrUndefined } from "util";
<span class="cstat-no" title="statement not covered" ></span>const localize = nls.loadMessageBundle();
&nbsp;
/**
 * Android specific platform implementation for debugging RN applications.
 */
<span class="cstat-no" title="statement not covered" ></span>export class AndroidPlatform extends GeneralMobilePlatform {
&nbsp;
    // We should add the common Android build/run errors we find to this list
    private static <span class="cstat-no" title="statement not covered" ></span>RUN_ANDROID_FAILURE_PATTERNS: PatternToFailure[] = [{
        pattern: "Failed to install on any devices",
        errorCode: InternalErrorCode.AndroidCouldNotInstallTheAppOnAnyAvailibleDevice,
    }, {
        pattern: "com.android.ddmlib.ShellCommandUnresponsiveException",
        errorCode: InternalErrorCode.AndroidShellCommandTimedOut,
    }, {
        pattern: "Android project not found",
        errorCode: InternalErrorCode.AndroidProjectNotFound,
&nbsp;
    }, {
        pattern: "error: more than one device/emulator",
        errorCode: InternalErrorCode.AndroidMoreThanOneDeviceOrEmulator,
    }, {
        pattern: /^Error: Activity class \{.*\} does not exist\.$/m,
        errorCode: InternalErrorCode.AndroidFailedToLaunchTheSpecifiedActivity,
    }];
&nbsp;
    private static <span class="cstat-no" title="statement not covered" ></span>RUN_ANDROID_SUCCESS_PATTERNS: string[] = ["BUILD SUCCESSFUL", "Starting the app", "Starting: Intent"];
&nbsp;
    private debugTarget: IDevice;
    private devices: IDevice[];
    private packageName: string;
    private <span class="cstat-no" title="statement not covered" ></span>logCatMonitor: LogCatMonitor | null = null;
    private adbHelper: AdbHelper;
&nbsp;
    private <span class="cstat-no" title="statement not covered" ></span>needsToLaunchApps: boolean = false;
&nbsp;
    public <span class="fstat-no" title="function not covered" >showDevMenu(deviceId?: string)</span>: Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.adbHelper.showDevMenu(deviceId);
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >reloadApp(deviceId?: string)</span>: Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.adbHelper.reloadApp(deviceId);
    }
&nbsp;
    // We set remoteExtension = null so that if there is an instance of androidPlatform that wants to have it's custom remoteExtension it can. This is specifically useful for tests.
<span class="fstat-no" title="function not covered" >    constructor(protected <span class="cstat-no" title="statement not covered" ></span>runOptions: IAndroidRunOptions, platformDeps: MobilePlatformDeps = {})</span> {
<span class="cstat-no" title="statement not covered" ></span>        super(runOptions, platformDeps);
<span class="cstat-no" title="statement not covered" ></span>        this.adbHelper = new AdbHelper(this.runOptions.projectRoot, this.logger);
    }
&nbsp;
    // TODO: remove this method when sinon will be updated to upper version. Now it is used for tests only.
    public <span class="fstat-no" title="function not covered" >setAdbHelper(adbHelper: AdbHelper)</span> {
<span class="cstat-no" title="statement not covered" ></span>        this.adbHelper = adbHelper;
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >runApp(shouldLaunchInAllDevices: boolean = false)</span>: Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        const extProps = {
            platform: {
                value: "android",
                isPii: false,
            },
        };
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>        return TelemetryHelper.generate("AndroidPlatform.runApp", extProps, () =&gt; {
<span class="cstat-no" title="statement not covered" ></span>            const env = this.getEnvArgument();
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>            return ReactNativeProjectHelper.getReactNativeVersion(this.runOptions.projectRoot)
                .then(version =&gt; {
<span class="cstat-no" title="statement not covered" >                    if (!semver.valid(version) /*Custom RN implementations should support this flag*/ || semver.gte(version, AndroidPlatform.NO_PACKAGER_VERSION)) {</span>
<span class="cstat-no" title="statement not covered" ></span>                        this.runArguments.push("--no-packager");
                    }
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>                    let mainActivity = GeneralMobilePlatform.getOptFromRunArgs(this.runArguments, "--main-activity");
&nbsp;
<span class="cstat-no" title="statement not covered" >                    if (mainActivity) {</span>
<span class="cstat-no" title="statement not covered" ></span>                        this.adbHelper.setLaunchActivity(mainActivity);
                    } else <span class="cstat-no" title="statement not covered" >if (!isNullOrUndefined(this.runOptions.debugLaunchActivity)) {</span>
<span class="cstat-no" title="statement not covered" ></span>                        this.runArguments.push("--main-activity", this.runOptions.debugLaunchActivity);
<span class="cstat-no" title="statement not covered" ></span>                        this.adbHelper.setLaunchActivity(this.runOptions.debugLaunchActivity);
                    }
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>                    const runAndroidSpawn = new CommandExecutor(this.projectPath, this.logger).spawnReactCommand("run-android", this.runArguments, {env});
<span class="cstat-no" title="statement not covered" ></span>                    const output = new OutputVerifier(
                        () =&gt;
<span class="cstat-no" title="statement not covered" >                            Q(AndroidPlatform.RUN_ANDROID_SUCCESS_PATTERNS),</span>
                        () =&gt;
<span class="cstat-no" title="statement not covered" >                            Q(AndroidPlatform.RUN_ANDROID_FAILURE_PATTERNS),</span>
                        "android").process(runAndroidSpawn);
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>                    return output
                        .finally(() =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                            return this.initializeTargetDevicesAndPackageName();
                        }).then(() =&gt; <span class="cstat-no" title="statement not covered" >[this.debugTarget], reason =&gt; {</span>
<span class="cstat-no" title="statement not covered" >                            if (reason.message === ErrorHelper.getInternalError(InternalErrorCode.AndroidMoreThanOneDeviceOrEmulator).message &amp;&amp; this.devices.length &gt; 1 &amp;&amp; this.debugTarget) {</span>
                                /* If it failed due to multiple devices, we'll apply this workaround to make it work anyways */
<span class="cstat-no" title="statement not covered" ></span>                                this.needsToLaunchApps = true;
<span class="cstat-no" title="statement not covered" ></span>                                return shouldLaunchInAllDevices
                                    ? this.adbHelper.getOnlineDevices()
                                    : Q([this.debugTarget]);
                            } else {
<span class="cstat-no" title="statement not covered" ></span>                                return Q.reject&lt;IDevice[]&gt;(reason);
                            }
                        }).then(devices =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                            return new PromiseUtil().forEach(devices, device =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                                return this.launchAppWithADBReverseAndLogCat(device);
                            });
                        });
                });
        });
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >enableJSDebuggingMode(</span>): Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.adbHelper.switchDebugMode(this.runOptions.projectRoot, this.packageName, true, this.debugTarget.id);
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >disableJSDebuggingMode(</span>): Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.adbHelper.switchDebugMode(this.runOptions.projectRoot, this.packageName, false, this.debugTarget.id);
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >prewarmBundleCache(</span>): Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.packager.prewarmBundleCache("android");
    }
&nbsp;
    public <span class="fstat-no" title="function not covered" >getRunArguments(</span>): string[] {
<span class="cstat-no" title="statement not covered" ></span>        let runArguments: string[] = [];
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (this.runOptions.runArguments  &amp;&amp; this.runOptions.runArguments.length &gt; 0) {</span>
<span class="cstat-no" title="statement not covered" ></span>            runArguments = this.runOptions.runArguments;
        } else {
<span class="cstat-no" title="statement not covered" >            if (this.runOptions.variant) {</span>
<span class="cstat-no" title="statement not covered" ></span>                runArguments.push("--variant", this.runOptions.variant);
            }
<span class="cstat-no" title="statement not covered" >            if (this.runOptions.target) {</span>
<span class="cstat-no" title="statement not covered" >                if (this.runOptions.target === AndroidPlatform.simulatorString ||</span>
                    this.runOptions.target === AndroidPlatform.deviceString) {
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>                    const message = localize("TargetIsNotSupportedForAndroid",
                     "Target {0} is not supported for Android platform. \n If you want to use particular device or simulator for launching Android app,\n please specify  device id (as in 'adb devices' output) instead.",
                      this.runOptions.target);
<span class="cstat-no" title="statement not covered" ></span>                    this.logger.warning(message);
                } else {
<span class="cstat-no" title="statement not covered" ></span>                    runArguments.push("--deviceId", this.runOptions.target);
                }
            }
        }
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>        return runArguments;
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >initializeTargetDevicesAndPackageName(</span>): Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return this.adbHelper.getConnectedDevices().then(devices =&gt; {
<span class="cstat-no" title="statement not covered" ></span>            this.devices = devices;
<span class="cstat-no" title="statement not covered" ></span>            this.debugTarget = this.getTargetEmulator(devices);
<span class="cstat-no" title="statement not covered" ></span>            return this.getPackageName().then(packageName =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                this.packageName = packageName;
            });
        });
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >launchAppWithADBReverseAndLogCat(device: IDevice)</span>: Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return Q({})
            .then(() =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                return this.configureADBReverseWhenApplicable(device);
            }).then(() =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                return this.needsToLaunchApps
                    ? this.adbHelper.launchApp(this.runOptions.projectRoot, this.packageName, device.id)
                    : Q&lt;void&gt;(void 0);
            }).then(() =&gt; {
<span class="cstat-no" title="statement not covered" ></span>                return this.startMonitoringLogCat(device, this.runOptions.logCatArguments);
            });
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >configureADBReverseWhenApplicable(device: IDevice)</span>: Q.Promise&lt;void&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return Q({}) // For other emulators and devices we try to enable adb reverse
            .then(() =&gt; <span class="cstat-no" title="statement not covered" >this.adbHelper.apiVersion(device.id))</span>
            .then(apiVersion =&gt; {
<span class="cstat-no" title="statement not covered" >                if (apiVersion &gt;= AndroidAPILevel.LOLLIPOP) { // If we support adb reverse</span>
<span class="cstat-no" title="statement not covered" ></span>                    return this.adbHelper.reverseAdb(device.id, Number(this.runOptions.packagerPort));
                } else {
<span class="cstat-no" title="statement not covered" ></span>                    const message = localize("DeviceSupportsOnlyAPILevel",
                     "Device {0} supports only API Level {1}. \n Level {2} is needed to support port forwarding via adb reverse. \n For debugging to work you'll need &lt;Shake or press menu button&gt; for the dev menu, \n go into &lt;Dev Settings&gt; and configure &lt;Debug Server host &amp; port for Device&gt; to be \n an IP address of your computer that the Device can reach. More info at: \n https://facebook.github.io/react-native/docs/debugging.html#debugging-react-native-apps",
                      device.id, apiVersion, AndroidAPILevel.LOLLIPOP);
<span class="cstat-no" title="statement not covered" ></span>                    this.logger.warning(message);
<span class="cstat-no" title="statement not covered" ></span>                    return void 0;
                }
            });
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >getPackageName(</span>): Q.Promise&lt;string&gt; {
<span class="cstat-no" title="statement not covered" ></span>        return new Package(this.runOptions.projectRoot).name().then(appName =&gt;
<span class="cstat-no" title="statement not covered" >                new PackageNameResolver(appName).resolvePackageName(this.runOptions.projectRoot));</span>
    }
&nbsp;
    /**
     * Returns the target emulator, using the following logic:
     * *  If an emulator is specified and it is connected, use that one.
     * *  Otherwise, use the first one in the list.
     */
    private <span class="fstat-no" title="function not covered" >getTargetEmulator(devices: IDevice[])</span>: IDevice {
<span class="cstat-no" title="statement not covered" ></span>        let activeFilterFunction = (device: IDevice) =&gt; {
<span class="cstat-no" title="statement not covered" ></span>            return device.isOnline;
        };
&nbsp;
<span class="cstat-no" title="statement not covered" ></span>        let targetFilterFunction = (device: IDevice) =&gt; {
<span class="cstat-no" title="statement not covered" ></span>            return device.id === this.runOptions.target &amp;&amp; activeFilterFunction(device);
        };
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (this.runOptions &amp;&amp; this.runOptions.target &amp;&amp; devices) {</span>
            /* check if the specified target is active */
<span class="cstat-no" title="statement not covered" ></span>            const targetDevice = devices.find(targetFilterFunction);
<span class="cstat-no" title="statement not covered" >            if (targetDevice) {</span>
<span class="cstat-no" title="statement not covered" ></span>                return targetDevice;
            }
        }
&nbsp;
        /* return the first active device in the list */
<span class="cstat-no" title="statement not covered" ></span>        let activeDevices = devices &amp;&amp; devices.filter(activeFilterFunction);
<span class="cstat-no" title="statement not covered" ></span>        return activeDevices &amp;&amp; activeDevices[0];
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >startMonitoringLogCat(device: IDevice, logCatArguments: string)</span>: void {
<span class="cstat-no" title="statement not covered" >        this.stopMonitoringLogCat(); // Stop previous logcat monitor if it's running</span>
&nbsp;
        // this.logCatMonitor can be mutated, so we store it locally too
<span class="cstat-no" title="statement not covered" ></span>        this.logCatMonitor = new LogCatMonitor(device.id, logCatArguments, this.adbHelper);
<span class="cstat-no" title="statement not covered" ></span>        this.logCatMonitor.start() // The LogCat will continue running forever, so we don't wait for it
            .catch(error =&gt; <span class="cstat-no" title="statement not covered" >this.logger.warning(localize("ErrorWhileMonitoringLogCat", "Error while monitoring LogCat"), error)) // The LogCatMonitor failing won't stop the debugging experience</span>
            .done();
    }
&nbsp;
    private <span class="fstat-no" title="function not covered" >stopMonitoringLogCat(</span>): void {
<span class="cstat-no" title="statement not covered" >        if (this.logCatMonitor) {</span>
<span class="cstat-no" title="statement not covered" ></span>            this.logCatMonitor.dispose();
<span class="cstat-no" title="statement not covered" ></span>            this.logCatMonitor = null;
        }
    }
}
&nbsp;</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Thu Sep 26 2019 09:04:01 GMT+0000 (Greenwich Mean Time)
</div>
</div>
<script src="../../../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../../../sorter.js"></script>
</body>
</html>
