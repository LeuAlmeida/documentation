// Generated by CoffeeScript 1.12.7

/*
X509_NAME_hash
 */
var asn1, crypto, der2, hex;

crypto = require('crypto');

asn1 = require('node-forge').asn1;

der2 = require('./der2');

hex = require('./hex');

module.exports = function(der) {
  var sha1;
  sha1 = crypto.createHash('sha1');
  der2(der2.asn1, der).subject.value.forEach(function(rdn) {
    var pair;
    rdn = asn1.copy(rdn);
    pair = rdn.value[0].value[1];
    pair.type = asn1.Type.UTF8;
    if (!pair.value) {
      return;
    }
    pair.value = pair.value.toLowerCase().replace(/\s+/g, ' ').replace(/^\s+|\s+$/, '');
    return sha1.update(asn1.toDer(rdn).getBytes(), 'binary');
  });
  return hex(sha1);
};
