// Generated by CoffeeScript 1.12.7

/*
X509_NAME_hash_old
 */
var asn1, crypto, der2, hex;

crypto = require('crypto');

asn1 = require('node-forge').asn1;

der2 = require('./der2');

hex = require('./hex');

module.exports = function(der) {
  var md5, subj;
  md5 = crypto.createHash('md5');
  subj = der2(der2.asn1, der).subject;
  md5.update(asn1.toDer(subj).getBytes(), 'binary');
  return hex(md5);
};
